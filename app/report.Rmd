---
title: Country-Level Institutional Assessment and Review (CLIAR)
subtitle: Institutional Benchmarking
output: 
  word_document
params:
  base_country: NA
  comparison_countries: NA
  data: NA
  family_data: NA
---

```{r, setup, include = FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.width = 9
)
```

```{r}

 # Auxiliary functions -----------------------------------------------------------------

  source(file.path("auxiliary",
                   "vars-by-family.R"))

  source(file.path("auxiliary",
                   "plots.R"))

  variable_names <-
    read_rds(file.path("data",
                       "variable_names.rds"))

  definitions <-
    read_rds(file.path("data",
                       "indicator_definitions.rds"))
```

**Base country:** `r params$base_country`


**Comparison countries:** `r paste(params$comparison_countries, collapse = ", ")`

# Country overview

```{r}
params$family_data %>%
  static_plot(params$base_country,
              "Country overview", 
              title = FALSE)
```

# Institutional families

```{r,  results = "asis"}
for (category in c("Strong", "Emerging", "Weak")) {
  
  families <-
    params$family_data %>%
    filter(country_name == params$base_country,
           str_detect(status, category)) %>%
    select(var_name) %>%
    unlist
  
  if (length(families) > 0) {
    
    family_names <- 
      paste(families, collapse = ", ")

    cat("\n##",
        category,
        "institutional capital:",
        family_names, 
        " \n")
  
    for (family in families) {
    
      vars <-
        variable_names %>%
        filter(family_name == family) %>%
        select(var_name) %>%
        unlist
    
      cat(
        "\n###",
        family,
        " \n"
      )
      
      plot(
        params$data %>%
          filter(var_name %in% vars) %>%
          static_plot(
            params$base_country,
            family,
            title = FALSE
          )
      )
      
      cat("\n")
    }
    
  }
}

params$data %>%
  filter(variable %in% vars_transp)  %>%
  static_plot(params$base_country,
              "Accountability institutions",
              title = FALSE) 
```

# Appendix - Indicator definitions

## Labor market institutions

```{r}
knitr::kable(definitions[["Labor market institutions"]], format = "pipe")
```

## Financial market institutions

```{r}
knitr::kable(definitions[["Financial market institutions"]], format = "pipe")
```

## Legal institutions

```{r}
knitr::kable(definitions[["Legal institutions"]], format = "pipe")
```

## Political institutions

```{r}
knitr::kable(definitions[["Political institutions"]], format = "pipe")
```

## Social institutions

```{r}
knitr::kable(definitions[["Social institutions"]], format = "pipe")
```

## Business environment and trade institutions

```{r}
knitr::kable(definitions[["Business environment and trade institutions"]], format = "pipe")
```


## Public sector performance institutions

```{r}
knitr::kable(definitions[["Public sector performance institutions"]], format = "pipe")
```

## Institutions for service delivery

```{r}
knitr::kable(definitions[["Institutions for service delivery"]], format = "pipe")
```

## Accountability institutions

```{r}
knitr::kable(definitions[["Accountability institutions"]], format = "pipe")
```
